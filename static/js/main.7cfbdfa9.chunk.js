(this["webpackJsonplegco-2020-frontend"]=this["webpackJsonplegco-2020-frontend"]||[]).push([[0],{41:function(e,t,a){e.exports=a(80)},46:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(37),i=a.n(r),s=(a(46),a(3)),l=a(4),o=a(7),u=a(6),d=a(38),h=a(2),m=a(8),p=a.n(m),f=a(18),b=a(40),v=a(15),y=a(14),g=a(1),k=a(10),O=a.n(k),j=a(16),E=(a(48),c.a.forwardRef((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"text"},t=arguments.length>1?arguments[1]:void 0,a=e.classList,n=Object(j.a)(e,["classList"]),r=O.a.apply(void 0,Object(f.a)(a||[]).concat(["legco-input"]));return c.a.createElement("input",Object.assign({},n,{className:r,ref:t}))}))),C=(a(49),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.keyword,a=e.handleKeywordChange,n=["search-box__input",t.length>0?"search-box__input--filled":null];return c.a.createElement("div",{className:"search-box"},c.a.createElement("label",{className:"legco-label search-box__label",htmlFor:"name_input"},"\u641c\u7d22\u5019\u9078\u4eba"),c.a.createElement(E,{classList:n,id:"name_input",name:"name",value:t,onChange:a}),c.a.createElement("button",{className:"search-box__button",type:"button"}))}}]),a}(n.Component)),_=(a(50),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.size,a=e.label,n=Object(j.a)(e,["size","label"]),r=O()("legco-checkbox","small"===t?"legco-checkbox--small":null);return c.a.createElement("div",{className:r},c.a.createElement("input",Object.assign({className:"legco-checkbox__input",type:"checkbox"},n)),c.a.createElement("label",{className:"legco-checkbox__label",htmlFor:n.id},a))}}]),a}(c.a.Component)),N=(a(51),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.size,a=e.label,n=Object(j.a)(e,["size","label"]),r=O()("legco-radio","small"===t?"legco-radio--small":null);return c.a.createElement("div",{className:r},c.a.createElement("input",Object.assign({className:"legco-radio__input",type:"radio"},n)),c.a.createElement("label",{className:"legco-radio__label",htmlFor:n.id},a))}}]),a}(c.a.Component)),w=(a(52),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"createOption",value:function(e,t){return c.a.createElement("option",{key:e,value:e},t)}},{key:"render",value:function(){var e=this.props,t=e.children,a=Object(j.a)(e,["children"]);return c.a.createElement("div",{className:"legco-listbox"},c.a.createElement("select",Object.assign({},a,{className:"legco-select"}),t))}}]),a}(c.a.Component)),x={constituencyType:"all",constituency:"all",camp:"all"},T={youngerThan36:!1,freshFace:!1,independent:!1,inPrimary:!1},I={constituencyType:[{id:"gc",name:"\u5730\u65b9\u9078\u5340"},{id:"fc",name:"\u529f\u80fd\u7d44\u5225\u9078\u5340"}],constituency:[],camp:[{id:"all",name:"\u4e0d\u9650"},{id:"est",name:"\u5efa\u5236\u6d3e"},{id:"dem",name:"\u6c11\u4e3b\u6d3e"},{id:"ctr",name:"\u4e2d\u9593\u6d3e"}]},F=[{id:"youngerThan36",name:"35\u5d57\u53ca\u4ee5\u4e0b\u5019\u9078\u4eba"},{id:"inPrimary",name:"\u53c3\u8207\u6c11\u4e3b\u6d3e\u521d\u9078"},{id:"freshFace",name:"\u9996\u6b21\u53c3\u9078\u7acb\u6cd5\u6703"},{id:"independent",name:"\u7121\u653f\u9ee8\u80cc\u666f"}],S=a(24),L=a(22),P=a.n(L),M=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"setConstituencies",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/assets/constituencies.json",e.prev=1,e.next=4,P.a.get("/assets/constituencies.json");case 4:if(t=e.sent,![200,201].includes(t.status)){e.next=9;break}this.constituencies=t.data,e.next=11;break;case 9:throw this.constituencies=[],Error(t.statusText);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"setCandidates",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/assets/candidates.json",e.prev=1,e.next=4,P.a.get("/assets/candidates.json");case 4:if(t=e.sent,![200,201].includes(t.status)){e.next=9;break}this.candidates=t.data,e.next=11;break;case 9:throw this.candidates=[],Error(t.statusText);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"setPersonalInfoList",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/assets/personalInfo.json",e.prev=1,e.next=4,P.a.get("/assets/personalInfo.json");case 4:if(t=e.sent,![200,201].includes(t.status)){e.next=9;break}this.personalInfoList=t.data,e.next=11;break;case 9:throw this.personalInfoList=[],Error(t.statusText);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getConstituencies",value:function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.constituencies){e.next=3;break}return e.next=3,this.setConstituencies();case 3:return e.abrupt("return",this.constituencies);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCandidates",value:function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.candidates){e.next=3;break}return e.next=3,this.setCandidates();case 3:return e.abrupt("return",this.candidates);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPersonalInfoList",value:function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.personalInfoList){e.next=3;break}return e.next=3,this.setPersonalInfoList();case 3:return e.abrupt("return",this.personalInfoList);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();M.constituencies=void 0,M.candidates=void 0,M.personalInfoList=void 0;var A=["constituencyType","constituency","camp"],D=["youngerThan36","inPrimary","freshFace","independent"],z=[].concat(A,D);function K(e){return null!==e}function R(e){return A.includes(e)}function B(e){return D.includes(e)}function J(e){return e.reduce((function(e,t){return Object(g.a)(Object(g.a)({},e),{},Object(y.a)({},t.id,t.type))}),{})}function W(e){return e.reduce((function(e,t){return Object(g.a)(Object(g.a)({},e),{},Object(y.a)({},t.id,t))}),{})}function $(e,t){return Object(g.a)(Object(g.a)({},e),{},{constituency:t.map((function(e){return{id:e.id,name:e.name}}))})}a(70);var q=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).createSelectOption=function(e,t){return c.a.createElement("option",{key:e,value:e},t)},e.createCheckbox=function(t,a,n,r){var i={id:t,label:a,checked:n,name:r||t,size:"small",onChange:function(){e.props.handleCheckboxChange(t)}};return c.a.createElement(_,Object.assign({key:t},i))},e.createRadioOption=function(t,a,n,r){var i={id:t,label:a,checked:n,size:"small",name:r,onChange:function(){e.props.handleSelectChange(r,t)}};return c.a.createElement(N,Object.assign({key:t},i))},e.handleConstTypeChange=function(t){var a=t.target.value;e.props.handleSelectChange("constituencyType",a)},e.handleConstChange=function(t){var a=t.target.value;e.props.handleSelectChange("constituency",a)},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.selected,n=t.checked,r=t.constituencies,i=J(r),s=$(I,r),l=s.constituency,o=s.constituencyType,u=s.camp,d=x.constituency,h=x.constituencyType,m=a.constituency,p=a.constituencyType,f=F.map((function(t){var a=t.id,c=t.name;return e.createCheckbox(a,c,n[a])})),b=o.map((function(t){return e.createSelectOption(t.id,t.name)})),v=l.filter((function(e){return i[e.id]===p})).map((function(t){return e.createSelectOption(t.id,t.name)})),y=u.map((function(t){var n=t.id,c=t.name;return e.createRadioOption(n,c,a.camp===n,"camp")}));return c.a.createElement("div",null,c.a.createElement("div",{className:"filters-group"},c.a.createElement("label",{className:"filters-group__label legco-label",htmlFor:"constituencyType"},"\u9078\u5340\u985e\u5225"),c.a.createElement("div",{className:"filters-group__options"},c.a.createElement(w,{id:"constituencyType",name:"constituencyType",value:p,onChange:this.handleConstTypeChange},c.a.createElement("option",{value:h},"\u6240\u6709\u9078\u5340\u985e\u5225"),b))),c.a.createElement("div",{className:"filters-group"},c.a.createElement("label",{className:"filters-group__label legco-label",htmlFor:"constituency_name"},"\u9078\u5340"),c.a.createElement("div",{className:"filters-group__options"},c.a.createElement(w,{id:"constituency_name",name:"constituency",value:m,onChange:this.handleConstChange,disabled:p===h},c.a.createElement("option",{value:d},"\u6240\u6709\u9078\u5340"),v))),c.a.createElement("div",{className:"filters-group"},c.a.createElement("label",{className:"filters-group__label legco-label"},"\u653f\u6cbb\u7acb\u5834"),c.a.createElement("div",{className:"filters-group__options legco-form-group"},y)),c.a.createElement("div",{className:"filters-group"},c.a.createElement("label",{className:"filters-group__label legco-label"},"\u500b\u4eba\u8cc7\u6599"),c.a.createElement("div",{className:"filters-group__options legco-form-group"},f)))}}]),a}(c.a.Component),G=(a(71),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleCheckboxTagClick=function(t){e.props.handleCheckboxChange(t)},e.handleSelectTagClick=function(t){var a=x[t];e.props.handleSelectChange(t,a)},e}return Object(l.a)(a,[{key:"createFilterTag",value:function(e,t,a){return c.a.createElement("div",{key:a,className:"filter-tag"},c.a.createElement("button",{className:"filter-tag__button",type:"button",onClick:e},c.a.createElement("span",{className:"filter-tag__cross-sign"},"\u2715"),t))}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.selected,r=a.checked,i=a.constituencies,s=$(I,i),l=Object.keys(n).filter(R).filter((function(e){return"camp"!==e&&n[e]!==x[e]})).map((function(e){var a=n[e],c=s[e].find((function(e){return e.id===a}));if(!c)throw Error("Couldn't find select option with ID ".concat(a,"."));return t.createFilterTag((function(){t.handleSelectTagClick(e)}),c.name,a)})),o=Object.keys(r).filter(B).filter((function(e){return r[e]!==T[e]})).map((function(e){var a=F.find((function(t){return t.id===e}));if(!a)throw Error("Couldn't find checkbox with ID ".concat(e,"."));return t.createFilterTag((function(){t.handleCheckboxTagClick(e)}),a.name,e)}));if(n.camp===x.camp)e=null;else{var u=n.camp,d=s.camp.find((function(e){return e.id===u}));if(!d)throw Error("Couldn't find select option with ID ".concat(u));e=this.createFilterTag((function(){t.handleSelectTagClick("camp")}),d.name,u)}var h=[{tags:l,label:"\u6240\u5c6c\u9078\u5340"},{tags:e?[e]:[],label:"\u653f\u6cbb\u7acb\u5834"},{tags:o,label:"\u500b\u4eba\u8cc7\u6599"}].filter((function(e){return e.tags.length>0})).map((function(e,t){var a=e.tags,n=e.label;return c.a.createElement("div",{key:t,className:"selected-filters__group"},c.a.createElement("span",{className:"selected-filters__label"},n),a)})),m=O()("selected-filters",h.length>0?"selected-filters--active":null);return c.a.createElement("div",{className:m},h)}}]),a}(c.a.Component)),H=(a(72),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).colorMap={dem:"yellow",est:"red",ctr:"dark-grey"},e.campMap={dem:"\u6c11\u4e3b\u6d3e",est:"\u5efa\u5236\u6d3e",ctr:"\u4e2d\u9593\u6d3e"},e}return Object(l.a)(a,[{key:"getColorFromCampId",value:function(e){return e?this.colorMap[e]:"green"}},{key:"getCampFromId",value:function(e){return e?this.campMap[e]:""}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.firstCandidate,n=e.list,r=e.affiliation,i=e.camp,s=r||"\u7368\u7acb".concat(this.getCampFromId(i)),l=a+(n?"\u5718\u968a":""),o=n?c.a.createElement("div",{className:"candidate-card__caption"},c.a.createElement("span",null,n.length,"\u4eba\u540d\u55ae")):null,u="/candidate/".concat(t),d=O()("candidate-card__header","candidate-card__header--".concat(this.getColorFromCampId(i)));return c.a.createElement("div",{className:"candidate-card"},c.a.createElement("div",{className:d},c.a.createElement("span",null,s)),c.a.createElement("a",{href:u,className:"candidate-card__link"},c.a.createElement("h3",{className:"candidate-card__name"},l)),o)}}]),a}(c.a.Component)),Q=(a(73),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).constituencies=[],n.candidates=[],n.personalInfoList=[],n.personalInfoMap={},n.constTypeLabelMap=I.constituencyType.reduce((function(e,t){return Object(g.a)(Object(g.a)({},e),{},Object(y.a)({},t.id,t.name))}),{}),n.toggleFilterPanel=function(){n.setState((function(e){return{showFiltersPanel:!e.showFiltersPanel}}))},n.handleKeywordChange=function(e){var t=e.target.value;n.setState({keyword:t})},n.handleSelectChange=function(e,t){n.setState((function(a){var n={selected:Object(g.a)(Object(g.a)({},a.selected),{},Object(y.a)({},e,t))};if("constituencyType"===e){var c=t,r=a.selected,i=r.constituencyType,s=r.constituency;n.selected.constituency=i!==c?x.constituency:s}return n}))},n.handleCheckboxChange=function(e){n.setState((function(t){var a=t.checked[e]||!1;return{checked:Object(g.a)(Object(g.a)({},t.checked),{},Object(y.a)({},e,!a))}}))},n.filterCandidates=function(e){var t=n.state,a=t.keyword,c=t.selected,r=t.checked,i=Object(g.a)(Object(g.a)({},c),r),s=Object(g.a)(Object(g.a)({},x),T),l=J(n.constituencies);return e.filter((function(e){var t=e.constituencyId,c=e.names,r=Array.isArray(c)?c[0]:c;if(a.length>0&&-1===r.search(a))return!1;var o,u=l[t],d=n.personalInfoMap[e.id],h=d.dob,m=d.affiliation,p=h?function(e){var t=S.DateTime.fromISO(e),a=S.DateTime.local();return Math.floor(a.diff(t,"years").years)}(h):null,f=Object(g.a)(Object(g.a)({},d),{},{constituencyType:u,constituency:t,youngerThan36:!!p&&p<36,independent:!m});for(var b in i)if(o=b,z.includes(o)){var v=b;if(i[v]===s[v])continue;if(i[v]!==f[v])return!1}return!0}))},n.state={keyword:"",checked:T,selected:x,resourceFetched:!1,showFiltersPanel:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all([M.getConstituencies(),M.getCandidates(),M.getPersonalInfoList()]).then((function(e){var a,n,c,r=Object(b.a)(e,3),i=r[0],s=r[1],l=r[2];(a=t.constituencies).push.apply(a,Object(f.a)(i)),(n=t.candidates).push.apply(n,Object(f.a)(s)),(c=t.personalInfoList).push.apply(c,Object(f.a)(l)),t.personalInfoMap=W(l),t.setState({resourceFetched:!0})})).catch((function(e){console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createCandidateCard",value:function(e){var t=e.id,a=e.names,n=this.personalInfoMap[t];if(!n)throw Error("Couldn't find information of candidate with ID ".concat(t,"."));var r=n.name,i=n.affiliation,s=n.camp,l={id:t,firstCandidate:r,list:Array.isArray(a)?a:null,affiliation:i,camp:s};return c.a.createElement(H,l)}},{key:"createConstituencySection",value:function(e,t){var a=this;if(!this.state.resourceFetched)return null;var n=e.id,r=e.name,i=e.type,s=this.constTypeLabelMap[i],l=t.filter((function(e){return e.constituencyId===n}));if(0===l.length)return null;var o=l.map((function(e){return c.a.createElement("li",{key:e.id,className:"candidates__item"},a.createCandidateCard(e))}));return c.a.createElement("section",{key:n,className:"candidates__section"},c.a.createElement("header",{className:"candidates__header"},c.a.createElement("h3",{className:"candidates__constituency-name"},r),c.a.createElement("span",{className:"candidates__constituency-type"},s)),c.a.createElement("ul",{className:"candidates__list"},o))}},{key:"render",value:function(){var e=this,t=this.state,a=t.keyword,n=t.selected,r=t.checked,i=t.showFiltersPanel,s=this.filterCandidates(this.candidates),l=this.constituencies.map((function(t){return e.createConstituencySection(t,s)})).filter(K),o={keyword:a,handleKeywordChange:this.handleKeywordChange},u={selected:n,checked:r,constituencies:this.constituencies,handleSelectChange:this.handleSelectChange,handleCheckboxChange:this.handleCheckboxChange},d={selected:n,checked:r,constituencies:this.constituencies,handleCheckboxChange:this.handleCheckboxChange,handleSelectChange:this.handleSelectChange},h=O()("filters-panel",i?"filters-panel--active":null),m=O()("home-page",i?"home-page--filters-panel-on":null);return c.a.createElement("div",{className:m},c.a.createElement("header",{className:"home-page__header"},c.a.createElement("div",{className:"legco-container"},c.a.createElement("h1",{className:"app-title"},c.a.createElement("span",{className:"app-subtitle"},"2016\u5e74\u7acb\u6cd5\u6703\u9078\u8209"),"\u5019\u9078\u4eba\u67e5\u8a62"))),c.a.createElement("div",{className:"candidate-finder"},c.a.createElement("div",{className:"legco-container"},c.a.createElement("form",null,c.a.createElement(C,o),c.a.createElement("div",null,c.a.createElement("button",{className:"candidate-finder__show-filters-btn",type:"button",onClick:this.toggleFilterPanel},"\u986f\u793a\u7be9\u9078\u689d\u4ef6")),c.a.createElement("div",{className:h},c.a.createElement("header",{className:"filters-panel__header"},c.a.createElement("h1",{className:"filters-panel__title"},"\u7be9\u9078\u689d\u4ef6"),c.a.createElement("button",{className:"filters-panel__go-back-btn",type:"button",onClick:this.toggleFilterPanel},"\u8fd4\u56de\u4e3b\u9801")),c.a.createElement("div",{className:"filters-panel__body"},c.a.createElement(q,u)),c.a.createElement("footer",{className:"filters-panel__footer"},c.a.createElement("div",{className:"legco-container"},c.a.createElement("button",{type:"button",className:"legco-button filters-panel__show-results-btn",onClick:this.toggleFilterPanel},"\u67e5\u770b",s.length,"\u500b\u7d50\u679c"))))))),c.a.createElement("div",{className:"legco-container"},c.a.createElement(G,d),c.a.createElement("div",{className:"candidates"},l)))}}]),a}(n.Component)),U=(a(74),function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return c.a.createElement(d.a,null,c.a.createElement(h.c,null,c.a.createElement(h.a,{path:"/"},c.a.createElement(Q,null))))}}]),a}(c.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.7cfbdfa9.chunk.js.map